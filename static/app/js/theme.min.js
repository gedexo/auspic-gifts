"use strict";

(function () {
    if ($(".dropdown-menu a.dropdown-toggle").length) {
        $(".dropdown-menu a.dropdown-toggle").on("click", function (e) {
            if ($(this).next().hasClass("show") || $(this).parents(".dropdown-menu").first().find(".show").removeClass("show"),
                $(this).next(".dropdown-menu").toggleClass("show"),
                $(this).parents("li.nav-item.dropdown.show").on("hidden.bs.dropdown", function (e) {
                    $(".dropdown-submenu .show").removeClass("show")
                }), !1);
        });
    }

    if ($('[data-bs-toggle="tooltip"]').length) {
        [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function (e) {
            return new bootstrap.Tooltip(e);
        });
    }

    if ($('[data-bs-toggle="popover"]').length) {
        [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]')).map(function (e) {
            return new bootstrap.Popover(e);
        });
    }

    if ($("#rater").length) {
        raterJs({
            starSize: 20,
            element: document.querySelector("#rater"),
            rateCallback: function (e, t) {
                this.setRating(e);
                t();
            }
        });
    }

    for (let i = 2; i <= 4; i++) {
        if ($(`#rate-${i}`).length) {
            raterJs({
                starSize: 20,
                element: document.querySelector(`#rate-${i}`),
                rateCallback: function (e, t) {
                    this.setRating(e);
                    t();
                }
            });
        }
    }

    if ($(".sidebar-nav-fixed a").length) {
        $(".sidebar-nav-fixed a").on("click", function (e) {
            if (location.pathname.replace(/^\//, "") == this.pathname.replace(/^\//, "") && location.hostname == this.hostname) {
                let target = $(this.hash);
                target = target.length ? target : $("[name=" + this.hash.slice(1) + "]");
                if (target.length) {
                    e.preventDefault();
                    $("html, body").animate({
                        scrollTop: target.offset().top - 90
                    }, 1000, function () {
                        let target = $(target);
                        if (target.focus(), target.is(":focus")) return !1;
                        target.attr("tabindex", "-1");
                        target.focus();
                    });
                }
            }

            $(".sidebar-nav-fixed a").each(function () {
                $(this).removeClass("active");
            });
            $(this).addClass("active");
        });
    }

    if ($(".flatpickr").length) {
        flatpickr(".flatpickr", {
            disableMobile: !0
        });
    }

    if ($(".stopevent").length) {
        $(document).on("off.bs.collapse.data-api", ".stopevent", function (e) {
            e.stopPropagation();
        });
    }

    if ($("#checkAll").length) {
        $("#checkAll").on("click", function () {
            $("input:checkbox").not(this).prop("checked", this.checked);
        });
    }

    if ($("#liveAlertPlaceholder").length) {
        const liveAlertPlaceholder = document.getElementById("liveAlertPlaceholder");
        const showAlert = (message, type) => {
            const alertDiv = document.createElement("div");
            alertDiv.innerHTML = [
                `<div class="alert alert-${type} alert-dismissible" role="alert">`,
                `   <div>${message}</div>`,
                '   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',
                "</div>"
            ].join("");
            liveAlertPlaceholder.append(alertDiv);
        };

        const liveAlertBtn = document.getElementById("liveAlertBtn");
        if (liveAlertBtn) {
            liveAlertBtn.addEventListener("click", () => {
                showAlert("Nice, you triggered this alert message!", "success");
            });
        }
    }


    $(".file-input").length && $(".file-input").change(function () {
        const image = $(this).parent().parent().find(".image");
        const reader = new FileReader();
        reader.onload = function (event) {
            image.attr("src", event.target.result);
        };
        reader.readAsDataURL(this.files[0]);
    });
})();

document.addEventListener("DOMContentLoaded", function () {
    const selectBoxes = document.querySelectorAll(".selectBox");
    Array.from(selectBoxes).forEach(function (selectBox) {
        const selectValue = selectBox.querySelector(".selectValue");
        const dropdownList = selectBox.querySelector("ul");
        Array.from(dropdownList.querySelectorAll("li")).forEach(function (item) {
            item.onclick = function () {
                Array.from(dropdownList.querySelectorAll(".dropdown-item")).forEach(function (el) {
                    el.classList.remove("active");
                });
                const link = this.querySelector("a");
                link.classList.add("active");
                selectValue.innerHTML = link.innerHTML;
            };
        });
    });
});
